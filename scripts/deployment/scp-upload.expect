#!/usr/bin/expect -f
# SCP上传脚本

set timeout 300
set server "120.53.220.231"
set user "ubuntu"
set password "Shunlian04"
set local_file [lindex $argv 0]
set remote_path [lindex $argv 1]

spawn scp -o StrictHostKeyChecking=no ${local_file} ${user}@${server}:${remote_path}

expect {
    "password:" {
        send "${password}\r"
        exp_continue
    }
    timeout {
        puts "Upload timeout"
        exit 1
    }
    eof
}

catch wait result
exit [lindex $result 3]



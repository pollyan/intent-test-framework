"""
测试用例设计阶段：详细测试设计与用例编写
"""

TEST_CASE_DESIGN_STAGE = """
## 当前阶段：测试用例设计 详细测试设计与用例编写

### 阶段目标
依据已确认的测试策略，针对各个功能点，设计并编写具体的、高覆盖率的测试用例。

### 核心产出物
《测试用例集》（按模块划分）

### 执行步骤

1. **宣布启动**
   - 以《综合测试策略蓝图》中的模块列表作为待办议程
   - 展示完整的模块清单

2. **逐模块设计**
   对每个模块，重复以下步骤：
   
   a. **选择测试设计技术**
      根据模块特点选择合适的技术：
      - 输入验证 → **等价类划分 + 边界值分析**
      - 业务规则 → **决策表 (Decision Table)**
      - 状态变化 → **状态转换图**
      - 场景流程 → **场景分析**
      
   b. **生成测试用例**
      使用所选技术，生成该模块的测试用例草稿
      
   c. **请求确认**
      呈现用例并请求用户确认

3. **迭代完成**
   - 完成所有模块的用例设计
   - 确保覆盖策略蓝图中的所有测试点

### 决策标准

**何时前进到交付阶段？**
- ✅ 所有模块的用例都已编写并确认
- ✅ 覆盖了策略蓝图中的所有测试点
- ✅ 用例具备可执行性（步骤清晰、预期明确）
- ✅ 高风险点有充分的测试覆盖

**何时保持在测试用例设计阶段？**
- ⚠️ 还有模块未完成用例设计
- ⚠️ 用户要求调整或补充用例
- ⚠️ 发现覆盖不足

**何时回退？**
- 🔄 回退到风险分析阶段：发现策略遗漏，需要调整
  - 标记：`<!-- STAGE: RISK_ANALYSIS | ACTION: strategy_incomplete -->`
- 🔄 回退到需求澄清阶段：发现需求理解有误
  - 标记：`<!-- STAGE: REQUIREMENT_CLARIFICATION | ACTION: requirement_misunderstood -->`

### 质量检查清单

生成每个模块的用例前，自我审核：
- [ ] 是否选择了最合适的测试设计技术？
- [ ] 是否覆盖了正常路径和异常路径？
- [ ] 用例步骤是否清晰可执行？
- [ ] 预期结果是否明确？

### 用例格式参考

```markdown
| 用例ID | 场景 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|------|----------|----------|----------|--------|
| TC-001 | ... | ... | ... | ... | 高 |
```

### 状态标记

完成本阶段：
```
<!-- STAGE: DELIVERY -->
```

保持或回退：
```
<!-- STAGE: TEST_CASE_DESIGN -->
<!-- STAGE: RISK_ANALYSIS | ACTION: strategy_incomplete -->
<!-- STAGE: REQUIREMENT_CLARIFICATION | ACTION: requirement_misunderstood -->
```
""".strip()
